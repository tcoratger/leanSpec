"""Tests for XMSS signature bincode serialization compatibility with Rust."""

from lean_spec.subspecs.koalabear import Fp
from lean_spec.subspecs.xmss.constants import XmssConfig
from lean_spec.subspecs.xmss.containers import PublicKey, Signature

# XMSS configuration matching the Rust test parameters
XMSS_CONFIG = XmssConfig(
    MESSAGE_LENGTH=32,
    LOG_LIFETIME=6,
    DIMENSION=163,
    BASE=2,
    FINAL_LAYER=3,
    TARGET_SUM=7,
    MAX_TRIES=1_000,
    PARAMETER_LEN=5,
    TWEAK_LEN_FE=2,
    MSG_LEN_FE=18,
    RAND_LEN_FE=5,
    HASH_LEN_FE=7,
    CAPACITY=9,
    POS_OUTPUT_LEN_PER_INV_FE=15,
    POS_INVOCATIONS=1,
)

# Test Data (Converted from Rust output)

RUST_PK_HEX = (
    "fc165f210bfc305d7700fc16db4f74fc92015e3dfcb85aab0ffcbb2afa59fccfc18a1bfc"
    "6a4ad80efc64484145fc4a82f210fc81759218fc67db4214"
)

RUST_SIG_HEX = (
    "06fc304f184bfcd37ab75ffc2b71a326fc17307b27fc5e2e7259fc9c099a4afc34037249"
    "fcbd28b43bfc236d074efc3a512870fcc5736d55fc1b968a4dfc18760b59fc6577247afc"
    "eabd6569fc41eb4313fceee7705bfcbad96b76fcc083852bfcd94e5a51fc0c4fba39fcca"
    "7f4972fcbbe54845fc5b07f312fc2ddba53bfcc50abd6dfca2a86538fc26432334fcb576"
    "1b3dfcb50b9153fce31d4413fcc1b88d18fc7e775967fcd6bc1366fca87c5311fc0713b9"
    "53fcc9932535fcf227fb5afcb17e342dfc236cb056fc6d507078fc20661962fc5397b768"
    "fc98c35614fcf1e96606fc3c020f46fcf0b5392ba3fcb99ba448fc3ef1811bfcadc9b010"
    "fc0a377a0cfc2676591efcaedb0013fceb4e5b0afc002e6d22fcfcaebb1efc14aea23bfc"
    "07a7b823fceb72171dfcdc8faa30fcac0b1d45fc00d6562bfc6ad18e12fce4f79a4ffc62"
    "dd5d7bfc3143136efcc5a04464fc19914e0cfc32a56373fc91368b38fc75edb922fc197b"
    "511bfc52c81350fcd18cb404fc62f60837fc52bc1e01fc1fe8882cfc45ecf214fc2cf49f"
    "32fcb21d6e55fc4b66c86dfc80b2d61bfcd2366f7bfceb851c68fc9aa0ff27fc631dc73e"
    "fc34bc0515fc406e827cfc57092345fc96c84923fc689b6d4afcaf0e3167fcdf44216afc"
    "4fed7a4efc2dcafe17fc974f443efcd93b2165fc60ab355efc8f544043fc04f5ad00fcf4"
    "a5ac28fc1378eb62fc923a5359fc48cad756fc94771d21fc4f4db02bfc189bb31afc82dd"
    "fa3dfc485e9607fc08c1ef59fcd73d0e12fc3a2b1b08fccd902517fc9e397a74fc16efa2"
    "42fcf8ba3f2efc28f1732ffc8acd2f7cfc1b637469fc420db01bfc6802b761fc70f5ea1a"
    "fcdb179d31fc7d3fa008fc73d96035fcd90eb566fc4c6f4d52fc2672c274fc7519e16cfc"
    "0d39d67bfccdd22434fc40a83f19fc0dff094dfc0cc13204fc8e75a373fc08fc4429fc38"
    "572c7cfce0e2000ffcc7214c51fce030ca72fc94485f28fca0dc7a57fc905f103ffcc3ed"
    "5818fcc7bea56ffc71817674fce7fa951efcb167203dfcb2e1360dfcf1874839fc8cd1f5"
    "05fc75942b26fc27e9aa4ffc9d1bf13cfc49c8e305fcb8c20639fc44bc0e26fc3071494d"
    "fc0e03216efc5f428a49fcff79b15cfca7ce392dfc27609314fc6ed3213dfc89509533fc"
    "59da9268fc33688f37fca3fbec0efc038b4a27fc1ae47838fc640afc65fce16bec4cfc45"
    "2ed32cfcde7aea5dfc6f99c532fc55b8de42fccf39cd64fcccecaa31fc2b73bc53fc995a"
    "b70efc0c069f39fc87a80226fcd975511afc1253d477fc5def4f48fcf437df78fc4fce83"
    "64fc11761277fc72e9db25fc51b14a6efcf7170359fcbe97713dfcc1f2e552fc82ea4032"
    "fcc8e78244fc4c7ea722fc6f24a72bfc3d134111fc1b0c0836fc65714e08fcd15a3945fc"
    "2779042dfcdad2426ffcc201a066fc5e46df6ffc73388568fc82467b06fc3c8f3c42fc72"
    "700366fc6f6aa328fc05dc2538fc0c8a6d53fcf54ead5efc427e7726fcb22d8814fc8abc"
    "d220fc940e9c05fc158bd85efca9d39520fc5e65c765fca13f5c55fcea177d15fc763667"
    "30fc0f744701fc3f29d014fc35e2ce10fc075c844efcff2e8f35fceb913777fc26131071"
    "fc7686bc1efcbc6daa49fc46a2ec7dfca8c8b600fc0255022bfc1eeef642fc7193b926fc"
    "818dd94ffc7770d017fc724d5c0bfc80f5aa01fcf522d76ffc1842333dfc37e3126ffce2"
    "02f505fc52f68903fc88494c3bfc6d470817fcdda9fb29fc79ec7171fc969b395bfc89e7"
    "6b58fc42440c38fc44c88f6cfc52046674fca00b1760fc58196d1ffc74184503fc884d8d"
    "15fc600b8934fc750cd711fcddc8de44fc1b3b1710fc7bfbe917fcd878b839fc9e6f4709"
    "fca2ee6970fc4b72a10bfce8a08d37fc245d1776fcc4192c4ffc9ed64d2afc4222ab73fc"
    "4f27ec4cfca1093738fca7caad30fc86a1cf03fcea29e456fc7e74ee44fcb14aaa60fc85"
    "85d403fccb65262afc465e7e6cfc644cb817fc27fd7158fc2217a34cfc3dc84f16fc3359"
    "034ffca57b0c6ffc87c70f7dfc3f791808fc7d99c27efc2093d47afceb6c0425fcd61784"
    "37fcf715940bfca64cbc35fc2ce44751fc146cab2dfc33cebb22fc285dc206fc698d3c6d"
    "fc3b125366fcb084690ffce7cb8860fc2b6a4043fc8490bb5dfc1672df38fcf670564afc"
    "3e35ba41fc5e963969fc13707816fce296095afc4f57d838fc78637109fc57451170fc42"
    "a6fc5afc0e9ce972fc144a432afc15814231fc5579416cfc4a86047bfc3f9ded30fc76a8"
    "5259fcd5345662fc58fc6069fc0d4a9326fc47db460dfc931e4411fcbb6aee60fc5f3078"
    "65fc7fd02079fc6b94cb5dfcc4323f64fca7714033fc6bde490cfc75ee6b7cfcd56c545c"
    "fcbef1a05ffc3d63c20cfce7d5e95ffcdc0b132cfcf6ab4310fc28511072fc8661681bfc"
    "b3a44051fc0df2cc02fcfc574f51fce053553afc29c9891bfc452ea607fc86c42301fc62"
    "0bff57fc0dca472bfc7c32d72cfc2426b329fcc679d32afc9f31c963fcb102e110fcbbec"
    "cc6bfc7d7dc46ffc64676f25fc1d1b1e05fc63fa194afcbad3d52efcf6737671fceb7d2e"
    "6ffc1b60623bfc363fcf22fc3e256004fc0aa5726cfc9e70586ffce1aa3811fc1ae92b4e"
    "fc1675e645fcef8edf31fc8f70fc66fcf7005943fc73126e13fc41207537fc553bb01ffc"
    "3c1aba6afcf8119e47fcfd1e7913fc1cfe1e7efc386ed526fc3b222903fcc545040bfc8a"
    "4c3906fc349cd651fcccda8d1dfc93a9be39fc06997004fc6cb4d532fc8abbb536fcae3f"
    "4d2dfcec957b3dfce19f0733fc00215334fc50c7c807fcb9584073fcf57bf053fc75b39b"
    "78fce2e4b80afc8119db59fc6ad58851fc2dc4cd23fc83d7e612fcbacd7d3dfcf7e6fc79"
    "fcc539907cfc8ec0036efcc0e63964fc644b3920fcdeba7240fc6154b975fc8dbf7b32fc"
    "7aab861afcc8485b70fc86263343fc7922710dfcfce7363dfcf93ac352fcdfebdc70fc5d"
    "f5a562fc3e12721cfc73de7701fcfa161706fcbd570f4efc02bc8f5ffc4e915946fc52f7"
    "0350fc6d23880dfcb52cde7cfce80c564efcd226742ffce649f967fc887ff116fc6cce43"
    "48fc7bd04711fceb39cc06fce63bce70fcbd47b203fcf6558677fccf7dd132fcbb60220d"
    "fc621e557cfce6777c6dfc9207b658fc1a93a431fc50655708fc3eaf6a64fc8d52dd40fc"
    "4afda545fc86a09d7afc473aee0ffc9c1a213bfcaf96b94bfc2857710efcac595f73fc84"
    "03ef51fcaee97a50fc4559ac67fcd79a2243fc58faef05fc7ea89826fc7acacf0efca9da"
    "fd60fccd8b391bfc8e4be403fc38423c71fcf5d24d1dfc44a34009fc5495926ffc2e7ee1"
    "3ffcd1d91d63fc58286a5bfc9c42fb5bfc1d8a1a74fc1f96b95ffc9a2c8913fc3ab2ea54"
    "fc0a6e075efc77bcbe19fcd5bc4778fca2bdf64efcfc54a644fc038bf010fc5c762612fc"
    "20700b78fc2caeec32fcb374b721fca8bea266fc68abd911fc6a343800fc10dc662efc2d"
    "b70834fcda103e53fc3dc2e310fca2ef6b25fc3d2c1d24fc3fc94276fcfaa2ea43fc42ec"
    "df3efc16670c45fc8c364356fc56273605fcff2f6e1afcf6a02e1efcfeca397dfc389485"
    "4afc9b89c368fc5eeb6742fc95a4e966fc11422610fcdce2f75ffc9747663afc25f07f56"
    "fc40b0a470fca66efd49fc34760330fc03ca8938fccb2f1927fcfb580208fcd5863c74fc"
    "63435143fc81c84245fc4134ee52fc161e201dfc0370d01bfc2c93860cfce1966d34fc28"
    "a47672fc1800df59fc35769053fc2a82e336fc97c67306fc1117e965fc69eff035fcbce8"
    "614cfc1351ca08fcf5b9c144fc44919475fc71e06628fc37064058fc04c9f349fc3555ea"
    "06fc3216801bfcae78a560fc4e25f35bfcecc4d364fc98d25d10fcda2a132cfc0bb2a20e"
    "fca6430504fca546033dfc07d5ff3efc52b24066fce6d16a10fcc364540ffc99191068fc"
    "4230c84efc3875926ffc0af82e77fca0508807fc40f2530bfc94127763fc9e80df39fcc7"
    "6fa13dfcf3ffd864fc5471435efc4919e20cfcb9f7687bfc99cbb068fcef42544cfcf0a4"
    "a72dfc034c9d2ffcad4ee26afc3b5f3147fc1430662afc9afb6528fc458b3831fcd05cc3"
    "51fcf8ec7c08fcf145a524fcabcd2376fc5be91c21fcf957d808fc1c8ba72cfc0d326e76"
    "fc3cdb0d22fcdadacd02fc979dbc00fc1e31562ffc4456a14afcfc02926dfc8accc747fc"
    "ede5be5dfc14bc7145fc0ab56077fce0360f24fca198e853fc5989a654fcb3b36d23fc96"
    "85a163fc136be31afc23f72164fcc002886afc25c6914ffcae493e00fcc0c70d15fc00d2"
    "e62afcb50f7b46fc6be01033fcbcecdd49fcb7f8f40efcc018c147fc5b488959fc785226"
    "0dfc6b6e2824fca6413e1afc5c566f51fcdb760452fc1d90ff22fc96c18230fcd8920023"
    "fcebe48277fcd1fde312fcbe8a432ffc90e95e62fca8854772fced9e1d07fc3cc36c6efc"
    "70d76833fc4f08211efcff361c18fc24da225afc150d5076fc571a7963fcabbef15bfcd3"
    "ebb021fced1aff79fc3b09b925fcda619a00fc4a6a2645fc0680fa42fc6cb12f2efc6001"
    "6729fc61f0134cfc1aa2ce23fcbc40c03cfca0be1d58fc23905b54fc37d6d220fc770bab"
    "2cfcf2174425fcde0d0042fccb341250fc1d80d16efcebbbd52bfc43269212fc2ebbdd32"
    "fc5263c956fc0a618b61fcef2a2416fc0f187a5bfc25368c70fc034cef7dfc5298b263fc"
    "f2a3b247fcacd18530fcd6087623fcb02f2a39fc2e7b3a56fcd1080316fcf9e19f71fc3a"
    "53507cfce04f753cfc01c16131fc69078e39fc686e1912fc9beeda30fc74148b1dfc8da9"
    "7143fc9154c733fc78a5100ffc12cd581ffc62e3875ffc0f221076fc10cce30bfca5a60a"
    "37fc1421dd40fceee95657fc731adf53fccab7fe34fc66c64b7dfcbfea0327fcdd80e72a"
    "fc35119267fc8560bf06fcdab6a30efceb25286dfcb5e27150fcd2db7b62fcdafc4d7bfc"
    "029be106fcf9e50d2cfc772ba31efce93d6c39fcbca25d75fcf0894f12fcfde98401fc03"
    "21ce01fcbfe5e96afc8d09603dfc8eb76d7dfcd965c249fc12e19c33fced523b43fc2d8e"
    "b871fc770fa96cfc0d5aa95ffc09092b22fcecb7d040fc856d860dfccd3be334fc81d682"
    "0ffccee95752fc4c93f001fc29caf913fcd2781315fc71605f33fcb636bd3cfca289d746"
    "fc96223868fc0721ab2ffca70ef757fc391c5b6cfc2c924221fc9faef066fc52317557fc"
    "37d6e22dfc5599cb7bfcdb74241cfc29364754fc03af371afc7921c171fc0b1d4a6dfcf9"
    "0fc579fc7cb4ad12fc951dc706fc65629965fc73694376fc2ef09370fca470a961fc9643"
    "ac0ffca5c9a713fce1345460fc243f8d63fc234f6b0bfc2af5ac46fcebd1d714fcd8d311"
    "60fcaac1d43ffc6767a878fcb6b32947fc6f366476fcc623322efc84d49c09fc1a8cc10c"
    "fcb7b0de45fcc2a41422fc3250c703fcb0071140fcdcdd4747fc14581d05fcefa9670efc"
    "a0a8a272fc0e096635fcc6661f48fc97680724fcb28bff76fc45c5ee49fc1c6a7353fc5b"
    "381c49fc042dc146fcfb36a57afcc2f0061efc29967536fcc3fb7d6ffc7b6fbb6dfc2dce"
    "7f17fcea30956dfc5e51d055fc23f45d22fc72d1e921fc1d01b005fc4c35962afc1d4983"
    "2bfcc7e8ad78fc7a879c2dfca29b2000fc42c51b39fcf13db47bfc43d6cf60fc7459d000"
    "fc52c1a105fc0c864b51fcf32a5802fceb281f2bfc2f67d20ffcb3140800fcade67b65fc"
    "1aef1c2cfc9f887622fc20d8a75dfc6fb3301efc2a6e5e4afc65de2756fc232cc23ffc2b"
    "19ae14fc3dcf0703fc6c39a418fc017e6234fc1552ef6efc5038b97cfc4bffad47fcbe13"
    "be38fc9e9b6b45fc587bd540fcd9ba7b74fc1cc33634fc883d3f2afcfc64e533fc211244"
    "2dfc9b2ae26ffc15556b5cfc3b4dcb2efc35ab727dfc13ee7908fc5baf2b04fcd238847b"
    "fc0567765afce661b023fcf3215c11fc04713238fc046f632afc9bbf685cfc8ae1ef09fc"
    "0bf0f100fc3388527dfc0ade325cfcdf82fd03fc72eca302fcd765bd32fc333b7e03fc4f"
    "7df123fc89e25970fc9dafbf14fc64472f1bfc6e0b2574fca9ce9851fc76f09311fc53e5"
    "3b53fc92d04d48fc024d5101fc6c005773fc27338134fc250de02ffca19b034efc00219b"
    "06fc4ae5cb14fc4d2d8115fc10257b7cfce33a1c73fc462ae405fcfd86630ffc7aa64e11"
    "fcb86a8630fc95fb6a72fc3f9ac436fc0e76183afc948b2854fce5d0ab73fc577faf4dfc"
    "c8890f09fc79a7b273fc30e26467fcb2256373fc70e80634fca4171f14fc3319cf62fcef"
    "2aa146fc2eeb7d60fc65921413fc62202a43fc86751f79fc0f78dc38fc5b8f7e67fc578f"
    "220dfc82f5402ffce68ad04ffca94e7b6bfc1cee9016fc9c11aa29fcc5987c45fc99d7a7"
    "37fcdcb67f79fcc4bf0407fcfc114630fc30134e04fc8056de63fcf9140112fcc0dfca43"
    "fcd2e65148fc4c2ad824fc3989b366fccd0e3843fc80cadd57fc0775e353fc79ff4716fc"
    "e2809204fc41c8cd45fc87106558fc9b5f641afc03d20f31fc5759c145fc3ebeb55efc54"
    "7eec0dfc0a750042fc6d0c3d68fc1d6b7a27fc9f525966fc14da2407fc7ce69a02fc29b8"
    "c554fcada89a0bfc1f403138fc72765e25fc35615160fcf9a0436bfc9ab13458fc8168a3"
    "07fc0e805a6afc6d98dc04fc9cc16c3ffc8e72d927fcfdf4f823fcf2a27251fce20a3819"
    "fc1ffa037efc4f616d6bfc63020954fce2e5e139fc412c115dfc4501354bfc7fba9c1efc"
    "a622b073fcd185d84bfc46ebc407fc9c955a5ffc99ee6e65fce2aa4669fcd972ed0dfcba"
    "21a14cfc95116030fc0a23be22fc67a47a32fcf58c5a34fc6879b749fc9aee6d60fc264e"
    "9b5bfc174af302fcd2f48f30fc94c9ff63fc7d347d64fc160f2013fc93672730fc2aa119"
    "3afc9b42a725fc7a65d904fc96c8291dfc2fb5695bfcc75b8e40fcd5c3a83efc7f19381e"
    "fc3c91d75dfc2c710166fce54b9a4bfc07bd9779fc8a827907fccf6ea217fcf98e7378fc"
    "e941aa68fc4dec9327fc9a92577dfc2b7d7e78fc8615b96bfcaa201055fcde9c4719fc9e"
    "d4e31efcc4490643fc9b69fb16fc8d312b1ffccd9c3630fcad640914fccb20c17afcb688"
    "5a6ffc5a075f35fc17c53603fca5374372fc8a00497afc7a652121fc489a9857fc74ccdc"
    "04fc86992670fce812e918fc4de13d7cfcc0609770fce04a6361fca331a76bfc9f073853"
    "fc7ee17754fc41c3c914fc4136c178fc872b0f51fcd4c10449fcbc77b962fcf8aeb261fc"
    "287bbb01fc1cabd20cfce62fb726fcd9cfba19fc1184a623fc7e374646fc8c6b871afccc"
    "d1962bfc08410e36fc684a7154fc868d2409fc24bb977cfcc24bf337fcc09fc177fc5fef"
    "1a0dfc33b46b0efc4f763f72fcd3ad411ffc82c29a2ffc78fdaf4bfc510d2235fcc95643"
    "28fcb80aa14efc1f5eb41afcc3abe528fc864d051efcd1c23411fc65b95052fcdcea460c"
    "fc69bfc425fc97772a37fc2b31ae14fc95949815fcf6a81333fcd1986f4efc90efe433fc"
    "6129df36fc465d4775fcfbc16018fc718a6572fcc60c8c1ffcbe921170fc99f11f4efc1e"
    "aefb01fc3e462c2efcf552380bfcb5aea243fc46391150fc38e67711fc5cd6ee33fc2be6"
    "cc72fcd813fa15fc1bd8c174fcdf72632dfc27631034fc352a3b0bfc48ec827efc67b0b6"
    "71fceb14e059fc64039260fcc00b4b49fc8d73792bfc38c4bf36fc77191a7cfc4dce7211"
    "fce7f04a6bfc8258630cfc0f082505fc3332262dfc9109fc4ffc8515d412fc696a894ffc"
    "2c48682cfc4aa9f82efc760c5f6ffc97dcb866fc0a895c16fc1fc14213fc4a6d1a5dfc1d"
    "38f959fc26a87c6efcd25c5f34fcad8a2803fca7d92f75fced7e0a52fc0975200bfcb3ca"
    "ca02fcfebbda29fca765da36fcdd674a15fcf5175c31fc691bb46bfccf26167afc0636fd"
    "6cfce8bd4d7afc39b77d3ffc799cd84ffc12808151fc9b261705fcb25e6748fc93bbc220"
    "fc6d451f72fc81052a7afc65ad104dfcdfa9e34afc66329409fcd28f0821fc46b5ff0dfc"
    "dc55e169fc9e59a065fcac24226ffc52246973fcc151e463fcf0c98d78fc25027e63fc6a"
    "96740efc5a4cf11ffce7334356fc381e9036fc125f2931fc7213ff5ffc477e0d5bfcd242"
    "966afca0cd3355fc70b6d603fcab6c6f05fc83623d48fcede8387dfccf8f892efc56facf"
    "29fc3a977f32fc3e09fe7bfc33cb674ffc22111d4bfcad483a52fc5044ee50fc7cf6c746"
    "fc4a4ca957fcf306bc20fcd99dbd64fc45264639fcd1975231fcea5ec746fc13eb724afc"
    "2496f73afcd9f9e759fcc9a7ec5dfc6768817afcb8e82d43fcee7ed436fc804dd471fcbd"
    "a89b2efc3341c373fc12f0585afc1659d714fcd32ddc7afc0116cd27fc0aea6e32fc6205"
    "6d61"
)

EXPECTED_PATH = [
    [
        Fp(value=1259884336),
        Fp(value=1605860051),
        Fp(value=648245547),
        Fp(value=662384663),
        Fp(value=1500655198),
        Fp(value=1251608988),
        Fp(value=1232208692),
    ],
    [
        Fp(value=1001662653),
        Fp(value=1309109539),
        Fp(value=1881690426),
        Fp(value=1433236421),
        Fp(value=1300928027),
        Fp(value=1493923352),
        Fp(value=2049210213),
    ],
    [
        Fp(value=1768275434),
        Fp(value=323218241),
        Fp(value=1534126062),
        Fp(value=1986779578),
        Fp(value=730170304),
        Fp(value=1364872921),
        Fp(value=968511244),
    ],
    [
        Fp(value=1917419466),
        Fp(value=1162405307),
        Fp(value=317917019),
        Fp(value=1000725293),
        Fp(value=1841105605),
        Fp(value=946186402),
        Fp(value=874726182),
    ],
    [
        Fp(value=1025210037),
        Fp(value=1402014645),
        Fp(value=323231203),
        Fp(value=411941057),
        Fp(value=1733916542),
        Fp(value=1712569558),
        Fp(value=290684072),
    ],
    [
        Fp(value=1404637959),
        Fp(value=891655113),
        Fp(value=1526409202),
        Fp(value=758415025),
        Fp(value=1454402595),
        Fp(value=2020626541),
        Fp(value=1645831712),
    ],
]

EXPECTED_RHO = [
    Fp(value=1756862291),
    Fp(value=341230488),
    Fp(value=107407857),
    Fp(value=1175388732),
    Fp(value=725202416),
]

EXPECTED_HASHES = [
    [
        Fp(value=1218747321),
        Fp(value=461500734),
        Fp(value=280021421),
        Fp(value=209336074),
        Fp(value=509179430),
        Fp(value=318823342),
        Fp(value=173756139),
    ],
    [
        Fp(value=577580544),
        Fp(value=515616508),
        Fp(value=1000517140),
        Fp(value=599303943),
        Fp(value=488076011),
        Fp(value=816484316),
        Fp(value=1159531436),
    ],
    [
        Fp(value=727111168),
        Fp(value=311349610),
        Fp(value=1335556068),
        Fp(value=2069749090),
        Fp(value=1846756145),
        Fp(value=1682219205),
        Fp(value=206475545),
    ],
    [
        Fp(value=1935910194),
        Fp(value=948647569),
        Fp(value=582610293),
        Fp(value=458324761),
        Fp(value=1343473746),
        Fp(value=78941393),
        Fp(value=923334242),
    ],
    [
        Fp(value=18791506),
        Fp(value=747169823),
        Fp(value=351464517),
        Fp(value=849343532),
        Fp(value=1433279922),
        Fp(value=1841849931),
        Fp(value=467055232),
    ],
    [
        Fp(value=2070886098),
        Fp(value=1746699755),
        Fp(value=671064218),
        Fp(value=1053236579),
        Fp(value=352697396),
        Fp(value=2088922688),
        Fp(value=1159924055),
    ],
    [
        Fp(value=592038038),
        Fp(value=1248697192),
        Fp(value=1731268271),
        Fp(value=1780565215),
        Fp(value=1316678991),
        Fp(value=402573869),
        Fp(value=1044664215),
    ],
    [
        Fp(value=1696676825),
        Fp(value=1580575584),
        Fp(value=1128289423),
        Fp(value=11400452),
        Fp(value=682403316),
        Fp(value=1659598867),
        Fp(value=1498626706),
    ],
    [
        Fp(value=1456982600),
        Fp(value=555579284),
        Fp(value=732974415),
        Fp(value=447978264),
        Fp(value=1039850882),
        Fp(value=127295048),
        Fp(value=1508884744),
    ],
    [
        Fp(value=302923223),
        Fp(value=135998266),
        Fp(value=388337869),
        Fp(value=1954167198),
        Fp(value=1117974294),
        Fp(value=775928568),
        Fp(value=796127528),
    ],
    [
        Fp(value=2083507594),
        Fp(value=1769235227),
        Fp(value=464522562),
        Fp(value=1639383656),
        Fp(value=451605872),
        Fp(value=832378843),
        Fp(value=144719741),
    ],
    [
        Fp(value=895539571),
        Fp(value=1723141849),
        Fp(value=1380806476),
        Fp(value=1958900262),
        Fp(value=1826691445),
        Fp(value=2077636877),
        Fp(value=874828493),
    ],
    [
        Fp(value=423602240),
        Fp(value=1292500749),
        Fp(value=70435084),
        Fp(value=1940092302),
        Fp(value=692386824),
        Fp(value=2083280696),
        Fp(value=251716320),
    ],
    [
        Fp(value=1363943879),
        Fp(value=1925853408),
        Fp(value=677333140),
        Fp(value=1467669664),
        Fp(value=1058037648),
        Fp(value=408481219),
        Fp(value=1873133255),
    ],
    [
        Fp(value=1953923441),
        Fp(value=513145575),
        Fp(value=1025533873),
        Fp(value=221700530),
        Fp(value=961054705),
        Fp(value=99996044),
        Fp(value=640390261),
    ],
    [
        Fp(value=1336600871),
        Fp(value=1022434205),
        Fp(value=98814025),
        Fp(value=956744376),
        Fp(value=638499908),
        Fp(value=1296658736),
        Fp(value=1847657230),
    ],
    [
        Fp(value=1233797727),
        Fp(value=1555134975),
        Fp(value=758763175),
        Fp(value=345202727),
        Fp(value=1025626990),
        Fp(value=865423497),
        Fp(value=1754454617),
    ],
    [
        Fp(value=932145203),
        Fp(value=250411939),
        Fp(value=659196675),
        Fp(value=947446810),
        Fp(value=1711016548),
        Fp(value=1290562529),
        Fp(value=752037445),
    ],
    [
        Fp(value=1575647966),
        Fp(value=851810671),
        Fp(value=1121892437),
        Fp(value=1691171279),
        Fp(value=833285324),
        Fp(value=1404859179),
        Fp(value=246897305),
    ],
    [
        Fp(value=966723084),
        Fp(value=637708423),
        Fp(value=441546201),
        Fp(value=2010403602),
        Fp(value=1213198173),
        Fp(value=2027894772),
        Fp(value=1686359631),
    ],
    [
        Fp(value=1997698577),
        Fp(value=635169138),
        Fp(value=1850388817),
        Fp(value=1493374967),
        Fp(value=1030854590),
        Fp(value=1390801601),
        Fp(value=843115138),
    ],
    [
        Fp(value=1149429704),
        Fp(value=581402188),
        Fp(value=732374127),
        Fp(value=289477437),
        Fp(value=906497051),
        Fp(value=139358565),
        Fp(value=1161386705),
    ],
    [
        Fp(value=755267879),
        Fp(value=1866650330),
        Fp(value=1721762242),
        Fp(value=1876903518),
        Fp(value=1753561203),
        Fp(value=108742274),
        Fp(value=1111265084),
    ],
    [
        Fp(value=1711501426),
        Fp(value=681798255),
        Fp(value=942005253),
        Fp(value=1399687692),
        Fp(value=1588416245),
        Fp(value=645365314),
        Fp(value=344468914),
    ],
    [
        Fp(value=550681738),
        Fp(value=94113428),
        Fp(value=1591249685),
        Fp(value=546689961),
        Fp(value=1707566430),
        Fp(value=1432108961),
        Fp(value=360519658),
    ],
    [
        Fp(value=812070518),
        Fp(value=21459983),
        Fp(value=349186367),
        Fp(value=281993781),
        Fp(value=1317297159),
        Fp(value=898576127),
        Fp(value=2000130539),
    ],
    [
        Fp(value=1896878886),
        Fp(value=515671670),
        Fp(value=1235905980),
        Fp(value=2112660038),
        Fp(value=11978920),
        Fp(value=721573122),
        Fp(value=1123479070),
    ],
    [
        Fp(value=649696113),
        Fp(value=1339657601),
        Fp(value=399536247),
        Fp(value=190598514),
        Fp(value=27981184),
        Fp(value=1876370165),
        Fp(value=1026769432),
    ],
    [
        Fp(value=1863508791),
        Fp(value=99943138),
        Fp(value=59373138),
        Fp(value=994855304),
        Fp(value=386418541),
        Fp(value=704358877),
        Fp(value=1903291513),
    ],
    [
        Fp(value=1530502038),
        Fp(value=1483466633),
        Fp(value=940328002),
        Fp(value=1821362244),
        Fp(value=1952842834),
        Fp(value=1612123040),
        Fp(value=527243608),
    ],
    [
        Fp(value=54859892),
        Fp(value=361581960),
        Fp(value=881396576),
        Fp(value=299306101),
        Fp(value=1155451101),
        Fp(value=269957915),
        Fp(value=401210235),
    ],
    [
        Fp(value=968390872),
        Fp(value=155676574),
        Fp(value=1885990562),
        Fp(value=195129931),
        Fp(value=932028648),
        Fp(value=1981242660),
        Fp(value=1328290244),
    ],
    [
        Fp(value=709744286),
        Fp(value=1940595266),
        Fp(value=1290544975),
        Fp(value=943131041),
        Fp(value=816695975),
        Fp(value=63938950),
        Fp(value=1457793514),
    ],
    [
        Fp(value=1156478078),
        Fp(value=1621772977),
        Fp(value=64259461),
        Fp(value=707159499),
        Fp(value=1820220998),
        Fp(value=397954148),
        Fp(value=1483865383),
    ],
    [
        Fp(value=1285756706),
        Fp(value=374327357),
        Fp(value=1325619507),
        Fp(value=1863089061),
        Fp(value=2098186119),
        Fp(value=135821631),
        Fp(value=2126682493),
    ],
    [
        Fp(value=2060751648),
        Fp(value=621047019),
        Fp(value=931403734),
        Fp(value=194254327),
        Fp(value=901532838),
        Fp(value=1363665964),
        Fp(value=766209044),
    ],
    [
        Fp(value=582733363),
        Fp(value=113401128),
        Fp(value=1832684905),
        Fp(value=1716720187),
        Fp(value=258573488),
        Fp(value=1619577831),
        Fp(value=1128294955),
    ],
    [
        Fp(value=1572573316),
        Fp(value=954167830),
        Fp(value=1247178998),
        Fp(value=1102722366),
        Fp(value=1765381726),
        Fp(value=376991763),
        Fp(value=1510577890),
    ],
    [
        Fp(value=953702223),
        Fp(value=158425976),
        Fp(value=1880180055),
        Fp(value=1526507074),
        Fp(value=1927912462),
        Fp(value=709052948),
        Fp(value=826442005),
    ],
    [
        Fp(value=1816230229),
        Fp(value=2063894090),
        Fp(value=820878655),
        Fp(value=1498589302),
        Fp(value=1649816789),
        Fp(value=1767963736),
        Fp(value=647186957),
    ],
    [
        Fp(value=222747463),
        Fp(value=289676947),
        Fp(value=1626237627),
        Fp(value=1702375519),
        Fp(value=2032193663),
        Fp(value=1573622891),
        Fp(value=1681863364),
    ],
    [
        Fp(value=859861415),
        Fp(value=206167659),
        Fp(value=2087448181),
        Fp(value=1549036757),
        Fp(value=1604383166),
        Fp(value=214065981),
        Fp(value=1609160167),
    ],
    [
        Fp(value=739445724),
        Fp(value=272870390),
        Fp(value=1913671976),
        Fp(value=459825542),
        Fp(value=1363190963),
        Fp(value=46985741),
        Fp(value=1364154364),
    ],
    [
        Fp(value=978670560),
        Fp(value=462014761),
        Fp(value=128331333),
        Fp(value=19121286),
        Fp(value=1476332386),
        Fp(value=726125069),
        Fp(value=752300668),
    ],
    [
        Fp(value=699606564),
        Fp(value=718502342),
        Fp(value=1674129823),
        Fp(value=283181745),
        Fp(value=1808592059),
        Fp(value=1875148157),
        Fp(value=628057956),
    ],
    [
        Fp(value=85859101),
        Fp(value=1243216483),
        Fp(value=785765306),
        Fp(value=1903588342),
        Fp(value=1865317867),
        Fp(value=996302875),
        Fp(value=584007478),
    ],
    [
        Fp(value=73409854),
        Fp(value=1819452682),
        Fp(value=1868066974),
        Fp(value=288926433),
        Fp(value=1311500570),
        Fp(value=1172731158),
        Fp(value=836734703),
    ],
    [
        Fp(value=1727819919),
        Fp(value=1129906423),
        Fp(value=325980787),
        Fp(value=930422849),
        Fp(value=531643221),
        Fp(value=1790581308),
        Fp(value=1201541624),
    ],
    [
        Fp(value=326704893),
        Fp(value=2115960348),
        Fp(value=651521592),
        Fp(value=53027387),
        Fp(value=184829381),
        Fp(value=104418442),
        Fp(value=1373019188),
    ],
    [
        Fp(value=495835852),
        Fp(value=968796563),
        Fp(value=74488070),
        Fp(value=852866156),
        Fp(value=917879690),
        Fp(value=760037294),
        Fp(value=1031509484),
    ],
    [
        Fp(value=856137697),
        Fp(value=877863168),
        Fp(value=130598736),
        Fp(value=1933596857),
        Fp(value=1408269301),
        Fp(value=2023469941),
        Fp(value=179889378),
    ],
    [
        Fp(value=1507531137),
        Fp(value=1367922026),
        Fp(value=600687661),
        Fp(value=317118339),
        Fp(value=1031654842),
        Fp(value=2046617335),
        Fp(value=2089826757),
    ],
    [
        Fp(value=1845739662),
        Fp(value=1681516224),
        Fp(value=540625764),
        Fp(value=1081260766),
        Fp(value=1975080033),
        Fp(value=846970765),
        Fp(value=445033338),
    ],
    [
        Fp(value=1885030600),
        Fp(value=1127425670),
        Fp(value=225518201),
        Fp(value=1027008508),
        Fp(value=1388526329),
        Fp(value=1893526495),
        Fp(value=1655043421),
    ],
    [
        Fp(value=477237822),
        Fp(value=24632947),
        Fp(value=102176506),
        Fp(value=1309628349),
        Fp(value=1603255298),
        Fp(value=1180275022),
        Fp(value=1342437202),
    ],
    [
        Fp(value=227025773),
        Fp(value=2094935221),
        Fp(value=1314262248),
        Fp(value=796141266),
        Fp(value=1744390630),
        Fp(value=384925576),
        Fp(value=1212403308),
    ],
    [
        Fp(value=289919099),
        Fp(value=114047467),
        Fp(value=1892563942),
        Fp(value=62015421),
        Fp(value=2005292534),
        Fp(value=852590031),
        Fp(value=220356795),
    ],
    [
        Fp(value=2085953122),
        Fp(value=1836873702),
        Fp(value=1488324498),
        Fp(value=832869146),
        Fp(value=139945296),
        Fp(value=1684713278),
        Fp(value=1088246413),
    ],
    [
        Fp(value=1168506186),
        Fp(value=2057150598),
        Fp(value=267270727),
        Fp(value=992025244),
        Fp(value=1270453935),
        Fp(value=242308904),
        Fp(value=1935628716),
    ],
    [
        Fp(value=1374618500),
        Fp(value=1350232494),
        Fp(value=1739348293),
        Fp(value=1126341335),
        Fp(value=99613272),
        Fp(value=647538814),
        Fp(value=248498810),
    ],
    [
        Fp(value=1627249321),
        Fp(value=456756173),
        Fp(value=65293198),
        Fp(value=1899774520),
        Fp(value=491639541),
        Fp(value=155231044),
        Fp(value=1871877460),
    ],
    [
        Fp(value=1071742510),
        Fp(value=1662900689),
        Fp(value=1533683800),
        Fp(value=1543193244),
        Fp(value=1947896349),
        Fp(value=1605998111),
        Fp(value=327756954),
    ],
    [
        Fp(value=1424667194),
        Fp(value=1577545226),
        Fp(value=431930487),
        Fp(value=2017967317),
        Fp(value=1324793250),
        Fp(value=1151751420),
        Fp(value=284199683),
    ],
    [
        Fp(value=304510556),
        Fp(value=2014015520),
        Fp(value=854371884),
        Fp(value=565671091),
        Fp(value=1721941672),
        Fp(value=299477864),
        Fp(value=3683434),
    ],
    [
        Fp(value=778492944),
        Fp(value=872986413),
        Fp(value=1396576474),
        Fp(value=283361853),
        Fp(value=627830690),
        Fp(value=605891645),
        Fp(value=1984088383),
    ],
    [
        Fp(value=1139450618),
        Fp(value=1054862402),
        Fp(value=1158440726),
        Fp(value=1447245452),
        Fp(value=87435094),
        Fp(value=443428863),
        Fp(value=506372342),
    ],
    [
        Fp(value=2100939518),
        Fp(value=1250268216),
        Fp(value=1757645211),
        Fp(value=1114106718),
        Fp(value=1726588053),
        Fp(value=270942737),
        Fp(value=1610080988),
    ],
    [
        Fp(value=979781527),
        Fp(value=1451225125),
        Fp(value=1889841216),
        Fp(value=1241345702),
        Fp(value=805533236),
        Fp(value=948554243),
        Fp(value=655962059),
    ],
    [
        Fp(value=134371579),
        Fp(value=1950123733),
        Fp(value=1129399139),
        Fp(value=1162004609),
        Fp(value=1391342657),
        Fp(value=488644118),
        Fp(value=466644995),
    ],
    [
        Fp(value=210146092),
        Fp(value=879597281),
        Fp(value=1920377896),
        Fp(value=1507786776),
        Fp(value=1401976373),
        Fp(value=920879658),
        Fp(value=108250775),
    ],
    [
        Fp(value=1709774609),
        Fp(value=904982377),
        Fp(value=1281484988),
        Fp(value=147476755),
        Fp(value=1153546741),
        Fp(value=1972670788),
        Fp(value=677830769),
    ],
    [
        Fp(value=1480590903),
        Fp(value=1240713476),
        Fp(value=116020533),
        Fp(value=461379122),
        Fp(value=1621457070),
        Fp(value=1542661454),
        Fp(value=1691600108),
    ],
    [
        Fp(value=274584216),
        Fp(value=739453658),
        Fp(value=245543435),
        Fp(value=67453862),
        Fp(value=1023624869),
        Fp(value=1056953607),
        Fp(value=1715515986),
    ],
    [
        Fp(value=275436006),
        Fp(value=257189059),
        Fp(value=1745885593),
        Fp(value=1321742402),
        Fp(value=1871869240),
        Fp(value=1999566858),
        Fp(value=126374048),
    ],
    [
        Fp(value=190050880),
        Fp(value=1668747924),
        Fp(value=970948766),
        Fp(value=1033990087),
        Fp(value=1691942899),
        Fp(value=1581478228),
        Fp(value=216144201),
    ],
    [
        Fp(value=2070476729),
        Fp(value=1756416921),
        Fp(value=1280590575),
        Fp(value=765961456),
        Fp(value=798837763),
        Fp(value=1793216173),
        Fp(value=1194417979),
    ],
    [
        Fp(value=711340052),
        Fp(value=677772186),
        Fp(value=825789253),
        Fp(value=1371757776),
        Fp(value=142404856),
        Fp(value=614811121),
        Fp(value=1982057899),
    ],
    [
        Fp(value=555542875),
        Fp(value=148396025),
        Fp(value=749177628),
        Fp(value=1986933261),
        Fp(value=571333436),
        Fp(value=47045338),
        Fp(value=12361111),
    ],
    [
        Fp(value=794177822),
        Fp(value=1252087364),
        Fp(value=1838285564),
        Fp(value=1204276362),
        Fp(value=1572791789),
        Fp(value=1165081620),
        Fp(value=2002826506),
    ],
    [
        Fp(value=604976864),
        Fp(value=1407752353),
        Fp(value=1420200281),
        Fp(value=594391987),
        Fp(value=1671529878),
        Fp(value=451111699),
        Fp(value=1679947555),
    ],
    [
        Fp(value=1787298496),
        Fp(value=1334953509),
        Fp(value=4082094),
        Fp(value=353224640),
        Fp(value=719770112),
        Fp(value=1182470069),
        Fp(value=856744043),
    ],
    [
        Fp(value=1239280828),
        Fp(value=250935479),
        Fp(value=1203837120),
        Fp(value=1502169179),
        Fp(value=220615288),
        Fp(value=606629483),
        Fp(value=440287654),
    ],
    [
        Fp(value=1366251100),
        Fp(value=1376024283),
        Fp(value=587173917),
        Fp(value=813875606),
        Fp(value=587240152),
        Fp(value=2005066987),
        Fp(value=316931537),
    ],
    [
        Fp(value=792955582),
        Fp(value=1650387344),
        Fp(value=1917289896),
        Fp(value=119381741),
        Fp(value=1852621628),
        Fp(value=862508912),
        Fp(value=505481295),
    ],
    [
        Fp(value=404502271),
        Fp(value=1512233508),
        Fp(value=1984957717),
        Fp(value=1668880983),
        Fp(value=1542569643),
        Fp(value=565242835),
        Fp(value=2046761709),
    ],
    [
        Fp(value=632883515),
        Fp(value=10117594),
        Fp(value=1160145482),
        Fp(value=1123713030),
        Fp(value=774877548),
        Fp(value=694616416),
        Fp(value=1276375137),
    ],
    [
        Fp(value=600744474),
        Fp(value=1019232444),
        Fp(value=1478344352),
        Fp(value=1415286819),
        Fp(value=550688311),
        Fp(value=749407095),
        Fp(value=625219570),
    ],
    [
        Fp(value=1107299806),
        Fp(value=1343370443),
        Fp(value=1859223581),
        Fp(value=735427563),
        Fp(value=311567939),
        Fp(value=853392174),
        Fp(value=1456038738),
    ],
    [
        Fp(value=1636524298),
        Fp(value=371469039),
        Fp(value=1534728207),
        Fp(value=1888237093),
        Fp(value=2112834563),
        Fp(value=1672648786),
        Fp(value=1202889714),
    ],
    [
        Fp(value=814076332),
        Fp(value=594938070),
        Fp(value=959066032),
        Fp(value=1446673198),
        Fp(value=369297617),
        Fp(value=1906303481),
        Fp(value=2085638970),
    ],
    [
        Fp(value=1014321120),
        Fp(value=828489985),
        Fp(value=965609321),
        Fp(value=303656552),
        Fp(value=819654299),
        Fp(value=495654004),
        Fp(value=1131522445),
    ],
    [
        Fp(value=868701329),
        Fp(value=252749176),
        Fp(value=525913362),
        Fp(value=1602741090),
        Fp(value=1980768783),
        Fp(value=199478288),
        Fp(value=923444901),
    ],
    [
        Fp(value=1088233748),
        Fp(value=1465313774),
        Fp(value=1407130227),
        Fp(value=889108426),
        Fp(value=2102117990),
        Fp(value=654568127),
        Fp(value=719814877),
    ],
    [
        Fp(value=1737625909),
        Fp(value=113205381),
        Fp(value=245610202),
        Fp(value=1831347691),
        Fp(value=1349640885),
        Fp(value=1652284370),
        Fp(value=2068708570),
    ],
    [
        Fp(value=115448578),
        Fp(value=739108345),
        Fp(value=514009975),
        Fp(value=963395049),
        Fp(value=1969070780),
        Fp(value=307202544),
        Fp(value=25487869),
    ],
    [
        Fp(value=30286083),
        Fp(value=1793713599),
        Fp(value=1029704077),
        Fp(value=2104342414),
        Fp(value=1237476825),
        Fp(value=865919250),
        Fp(value=1127961325),
    ],
    [
        Fp(value=1907920429),
        Fp(value=1823018871),
        Fp(value=1604934157),
        Fp(value=573245705),
        Fp(value=1087420396),
        Fp(value=226913669),
        Fp(value=887307213),
    ],
    [
        Fp(value=260232833),
        Fp(value=1381493198),
        Fp(value=32543564),
        Fp(value=335137321),
        Fp(value=353597650),
        Fp(value=861888625),
        Fp(value=1019033270),
    ],
    [
        Fp(value=1188530594),
        Fp(value=1748509334),
        Fp(value=799744263),
        Fp(value=1475808935),
        Fp(value=1817910329),
        Fp(value=558010924),
        Fp(value=1727049375),
    ],
    [
        Fp(value=1467298130),
        Fp(value=769840695),
        Fp(value=2076940629),
        Fp(value=472151259),
        Fp(value=1413953065),
        Fp(value=439856899),
        Fp(value=1908482425),
    ],
    [
        Fp(value=1833573643),
        Fp(value=2042957817),
        Fp(value=313373820),
        Fp(value=113712533),
        Fp(value=1704551013),
        Fp(value=1984129395),
        Fp(value=1888743470),
    ],
    [
        Fp(value=1638494372),
        Fp(value=262947734),
        Fp(value=329763237),
        Fp(value=1616131297),
        Fp(value=1670201124),
        Fp(value=191581987),
        Fp(value=1185740074),
    ],
    [
        Fp(value=349688299),
        Fp(value=1611781080),
        Fp(value=1070907818),
        Fp(value=2024302439),
        Fp(value=1193915318),
        Fp(value=1986279023),
        Fp(value=775037894),
    ],
    [
        Fp(value=161272964),
        Fp(value=214010906),
        Fp(value=1172222135),
        Fp(value=571778242),
        Fp(value=63393842),
        Fp(value=1074857904),
        Fp(value=1195892188),
    ],
    [
        Fp(value=85809172),
        Fp(value=241674735),
        Fp(value=1923262624),
        Fp(value=895879438),
        Fp(value=1210017478),
        Fp(value=604465303),
        Fp(value=1996458930),
    ],
    [
        Fp(value=1240384837),
        Fp(value=1400072732),
        Fp(value=1226586203),
        Fp(value=1187065092),
        Fp(value=2057647867),
        Fp(value=503771330),
        Fp(value=913675817),
    ],
    [
        Fp(value=1870527427),
        Fp(value=1841000315),
        Fp(value=394251821),
        Fp(value=1838493930),
        Fp(value=1439715678),
        Fp(value=576582691),
        Fp(value=568971634),
    ],
    [
        Fp(value=95420701),
        Fp(value=714487116),
        Fp(value=730024221),
        Fp(value=2024663239),
        Fp(value=765233018),
        Fp(value=2136994),
        Fp(value=958121282),
    ],
    [
        Fp(value=2075409905),
        Fp(value=1624233539),
        Fp(value=13654388),
        Fp(value=94486866),
        Fp(value=1363904012),
        Fp(value=39332595),
        Fp(value=723462379),
    ],
    [
        Fp(value=265447215),
        Fp(value=529587),
        Fp(value=1702618797),
        Fp(value=740093722),
        Fp(value=578193567),
        Fp(value=1571280928),
        Fp(value=506508143),
    ],
    [
        Fp(value=1247702570),
        Fp(value=1445453413),
        Fp(value=1069689891),
        Fp(value=346954027),
        Fp(value=50843453),
        Fp(value=413415788),
        Fp(value=878870017),
    ],
    [
        Fp(value=1861177877),
        Fp(value=2092513360),
        Fp(value=1202585419),
        Fp(value=951980990),
        Fp(value=1164680094),
        Fp(value=1087732568),
        Fp(value=1954265817),
    ],
    [
        Fp(value=876004124),
        Fp(value=708787592),
        Fp(value=870671612),
        Fp(value=759435809),
        Fp(value=1877093019),
        Fp(value=1550538005),
        Fp(value=785075515),
    ],
    [
        Fp(value=2104666933),
        Fp(value=142208531),
        Fp(value=69971803),
        Fp(value=2072262866),
        Fp(value=1517709061),
        Fp(value=598761958),
        Fp(value=291250675),
    ],
    [
        Fp(value=942829828),
        Fp(value=711159556),
        Fp(value=1550368667),
        Fp(value=166715786),
        Fp(value=15855627),
        Fp(value=2102560819),
        Fp(value=1546837514),
    ],
    [
        Fp(value=66945759),
        Fp(value=44297330),
        Fp(value=851273175),
        Fp(value=58604339),
        Fp(value=603028815),
        Fp(value=1884938889),
        Fp(value=348106653),
    ],
    [
        Fp(value=456083300),
        Fp(value=1948584814),
        Fp(value=1368968873),
        Fp(value=294908022),
        Fp(value=1396434259),
        Fp(value=1213059218),
        Fp(value=22105346),
    ],
    [
        Fp(value=1935081580),
        Fp(value=880882471),
        Fp(value=803212581),
        Fp(value=1308859297),
        Fp(value=110829824),
        Fp(value=348906826),
        Fp(value=360787277),
    ],
    [
        Fp(value=2088445200),
        Fp(value=1931229923),
        Fp(value=98839110),
        Fp(value=258180861),
        Fp(value=290367098),
        Fp(value=814115512),
        Fp(value=1919613845),
    ],
    [
        Fp(value=918854207),
        Fp(value=974681614),
        Fp(value=1411943316),
        Fp(value=1940639973),
        Fp(value=1303347031),
        Fp(value=152013256),
        Fp(value=1941088121),
    ],
    [
        Fp(value=1734664752),
        Fp(value=1935877554),
        Fp(value=872867952),
        Fp(value=337581988),
        Fp(value=1657739571),
        Fp(value=1184967407),
        Fp(value=1618864942),
    ],
    [
        Fp(value=320115301),
        Fp(value=1126834274),
        Fp(value=2032104838),
        Fp(value=953972751),
        Fp(value=1736347483),
        Fp(value=220368727),
        Fp(value=792786306),
    ],
    [
        Fp(value=1339067110),
        Fp(value=1803243177),
        Fp(value=378596892),
        Fp(value=699011484),
        Fp(value=1165793477),
        Fp(value=933746585),
        Fp(value=2038413020),
    ],
    [
        Fp(value=117751748),
        Fp(value=809898492),
        Fp(value=72225584),
        Fp(value=1675515520),
        Fp(value=302060793),
        Fp(value=1137369024),
        Fp(value=1213327058),
    ],
    [
        Fp(value=618146380),
        Fp(value=1723042105),
        Fp(value=1127747277),
        Fp(value=1474153088),
        Fp(value=1407415559),
        Fp(value=373817209),
        Fp(value=76710114),
    ],
    [
        Fp(value=1171114049),
        Fp(value=1483018375),
        Fp(value=442785691),
        Fp(value=823120387),
        Fp(value=1170299223),
        Fp(value=1588969022),
        Fp(value=233602644),
    ],
    [
        Fp(value=1107326218),
        Fp(value=1748831341),
        Fp(value=662334237),
        Fp(value=1717129887),
        Fp(value=119855636),
        Fp(value=43705980),
        Fp(value=1422243881),
    ],
    [
        Fp(value=194685101),
        Fp(value=942751775),
        Fp(value=626947698),
        Fp(value=1615946037),
        Fp(value=1799594233),
        Fp(value=1479848346),
        Fp(value=128149633),
    ],
    [
        Fp(value=1784315918),
        Fp(value=81565805),
        Fp(value=1064092060),
        Fp(value=668562062),
        Fp(value=603518205),
        Fp(value=1366467314),
        Fp(value=423103202),
    ],
    [
        Fp(value=2114189855),
        Fp(value=1802330447),
        Fp(value=1409876579),
        Fp(value=971105762),
        Fp(value=1561406529),
        Fp(value=1261764933),
        Fp(value=513587839),
    ],
    [
        Fp(value=1940923046),
        Fp(value=1272481233),
        Fp(value=130345798),
        Fp(value=1599772060),
        Fp(value=1701768857),
        Fp(value=1766238946),
        Fp(value=233665241),
    ],
    [
        Fp(value=1285628346),
        Fp(value=811602325),
        Fp(value=582886154),
        Fp(value=846898279),
        Fp(value=878349557),
        Fp(value=1236760936),
        Fp(value=1617817242),
    ],
    [
        Fp(value=1536904742),
        Fp(value=49498647),
        Fp(value=814740690),
        Fp(value=1677707668),
        Fp(value=1685927037),
        Fp(value=320868118),
        Fp(value=807888787),
    ],
    [
        Fp(value=974758186),
        Fp(value=631718555),
        Fp(value=81356154),
        Fp(value=489277590),
        Fp(value=1533654319),
        Fp(value=1083071431),
        Fp(value=1051247573),
    ],
    [
        Fp(value=506993023),
        Fp(value=1574408508),
        Fp(value=1711370540),
        Fp(value=1268403173),
        Fp(value=2039987463),
        Fp(value=125403786),
        Fp(value=396521167),
    ],
    [
        Fp(value=2020839161),
        Fp(value=1755988457),
        Fp(value=664005709),
        Fp(value=2102891162),
        Fp(value=2021555499),
        Fp(value=1807291782),
        Fp(value=1427120298),
    ],
    [
        Fp(value=424123614),
        Fp(value=518247582),
        Fp(value=1124485572),
        Fp(value=385575323),
        Fp(value=522924429),
        Fp(value=808885453),
        Fp(value=336159917),
    ],
    [
        Fp(value=2059477195),
        Fp(value=1868204214),
        Fp(value=895420250),
        Fp(value=53921047),
        Fp(value=1917007781),
        Fp(value=2051604618),
        Fp(value=555836794),
    ],
    [
        Fp(value=1469618760),
        Fp(value=81579124),
        Fp(value=1881577862),
        Fp(value=417927912),
        Fp(value=2084430157),
        Fp(value=1888968896),
        Fp(value=1633897184),
    ],
    [
        Fp(value=1806119331),
        Fp(value=1396180895),
        Fp(value=1417142654),
        Fp(value=348767041),
        Fp(value=2025928257),
        Fp(value=1359948679),
        Fp(value=1225048532),
    ],
    [
        Fp(value=1656321980),
        Fp(value=1639100152),
        Fp(value=29063976),
        Fp(value=215132956),
        Fp(value=649539558),
        Fp(value=431673305),
        Fp(value=598115345),
    ],
    [
        Fp(value=1179006846),
        Fp(value=445082508),
        Fp(value=731304396),
        Fp(value=906903816),
        Fp(value=1416710760),
        Fp(value=153390470),
        Fp(value=2090318628),
    ],
    [
        Fp(value=938691522),
        Fp(value=2009178048),
        Fp(value=219869023),
        Fp(value=241939507),
        Fp(value=1916761679),
        Fp(value=524398035),
        Fp(value=798671490),
    ],
    [
        Fp(value=1269824888),
        Fp(value=891424081),
        Fp(value=675501769),
        Fp(value=1319176888),
        Fp(value=448028191),
        Fp(value=686140355),
        Fp(value=503664006),
    ],
    [
        Fp(value=288670417),
        Fp(value=1381022053),
        Fp(value=205974236),
        Fp(value=633651049),
        Fp(value=925530007),
        Fp(value=346960171),
        Fp(value=362321045),
    ],
    [
        Fp(value=856926454),
        Fp(value=1315936465),
        Fp(value=870641552),
        Fp(value=920594785),
        Fp(value=1967611206),
        Fp(value=408994299),
        Fp(value=1919257201),
    ],
    [
        Fp(value=529272006),
        Fp(value=1880199870),
        Fp(value=1310716313),
        Fp(value=33271326),
        Fp(value=774653502),
        Fp(value=188240629),
        Fp(value=1134735029),
    ],
    [
        Fp(value=1343306054),
        Fp(value=293070392),
        Fp(value=871290460),
        Fp(value=1926030891),
        Fp(value=368710616),
        Fp(value=1958860827),
        Fp(value=761492191),
    ],
    [
        Fp(value=873489191),
        Fp(value=188426805),
        Fp(value=2122509384),
        Fp(value=1907798119),
        Fp(value=1507857643),
        Fp(value=1620181860),
        Fp(value=1229654976),
    ],
    [
        Fp(value=729379725),
        Fp(value=918537272),
        Fp(value=2082085239),
        Fp(value=292736589),
        Fp(value=1800073447),
        Fp(value=207837314),
        Fp(value=86312975),
    ],
    [
        Fp(value=757477939),
        Fp(value=1341917585),
        Fp(value=315889029),
        Fp(value=1334405737),
        Fp(value=745031724),
        Fp(value=788048202),
        Fp(value=1868500086),
    ],
    [
        Fp(value=1723391127),
        Fp(value=375163146),
        Fp(value=323141919),
        Fp(value=1562013002),
        Fp(value=1509505053),
        Fp(value=1853663270),
        Fp(value=878664914),
    ],
    [
        Fp(value=52988589),
        Fp(value=1966070183),
        Fp(value=1376419565),
        Fp(value=186676489),
        Fp(value=46844595),
        Fp(value=702200830),
        Fp(value=920282535),
    ],
    [
        Fp(value=357197789),
        Fp(value=828119029),
        Fp(value=1806965609),
        Fp(value=2048272079),
        Fp(value=1828533766),
        Fp(value=2051915240),
        Fp(value=1065203513),
    ],
    [
        Fp(value=1339595897),
        Fp(value=1367441426),
        Fp(value=85403291),
        Fp(value=1214734002),
        Fp(value=549632915),
        Fp(value=1914652013),
        Fp(value=2049574273),
    ],
    [
        Fp(value=1292938597),
        Fp(value=1256434143),
        Fp(value=160707174),
        Fp(value=554209234),
        Fp(value=234861894),
        Fp(value=1776375260),
        Fp(value=1705007518),
    ],
    [
        Fp(value=1864508588),
        Fp(value=1936270418),
        Fp(value=1675907521),
        Fp(value=2022558192),
        Fp(value=1669202469),
        Fp(value=242521706),
        Fp(value=535907418),
    ],
    [
        Fp(value=1447244775),
        Fp(value=915414584),
        Fp(value=824794898),
        Fp(value=1610552178),
        Fp(value=1527610951),
        Fp(value=1788232402),
        Fp(value=1429458336),
    ],
    [
        Fp(value=64403056),
        Fp(value=91188395),
        Fp(value=1211982467),
        Fp(value=2100881645),
        Fp(value=780767183),
        Fp(value=701495894),
        Fp(value=847222586),
    ],
    [
        Fp(value=2080246078),
        Fp(value=1332202291),
        Fp(value=1260196130),
        Fp(value=1379551405),
        Fp(value=1357792336),
        Fp(value=1187509884),
        Fp(value=1470712906),
    ],
    [
        Fp(value=549193459),
        Fp(value=1690148313),
        Fp(value=960898629),
        Fp(value=827496401),
        Fp(value=1187471082),
        Fp(value=1249045267),
        Fp(value=989304356),
    ],
    [
        Fp(value=1508375001),
        Fp(value=1575790537),
        Fp(value=2055301223),
        Fp(value=1127082168),
        Fp(value=919895790),
        Fp(value=1909738880),
        Fp(value=781953213),
    ],
    [
        Fp(value=1942176051),
        Fp(value=1515778066),
        Fp(value=349657366),
        Fp(value=2061250003),
        Fp(value=667751937),
        Fp(value=846129674),
        Fp(value=1634534754),
    ],
]


class TestSignatureSerialization:
    """Test Signature and PublicKey serialization/deserialization against Rust bincode reference."""

    def test_deserialize_signature(self) -> None:
        """Test deserializing signature from Rust bincode output."""
        # Deserialize signature
        sig_bytes = bytes.fromhex(RUST_SIG_HEX)
        signature = Signature.from_bincode_bytes(sig_bytes, XMSS_CONFIG)

        # Verify signature structure lengths
        assert len(signature.path.siblings) == XMSS_CONFIG.LOG_LIFETIME
        assert len(signature.rho) == len(EXPECTED_RHO)
        assert len(signature.hashes) == len(EXPECTED_HASHES)

        # Verify Path Siblings (all 6 siblings)
        for i, (got_sibling, expected_sibling) in enumerate(
            zip(signature.path.siblings, EXPECTED_PATH, strict=True)
        ):
            for j, (got_fp, expected_fp) in enumerate(
                zip(got_sibling, expected_sibling, strict=True)
            ):
                assert got_fp == expected_fp, (
                    f"Path sibling[{i}][{j}] mismatch: expected {expected_fp}, got {got_fp}"
                )

        # Verify Rho
        for i, (got_fp, expected_fp) in enumerate(zip(signature.rho, EXPECTED_RHO, strict=True)):
            assert got_fp == expected_fp, f"Rho[{i}] mismatch: expected {expected_fp}, got {got_fp}"

        # Verify Hashes
        for i, (got_hash, expected_hash) in enumerate(
            zip(signature.hashes, EXPECTED_HASHES, strict=True)
        ):
            for j, (got_fp, expected_fp) in enumerate(zip(got_hash, expected_hash, strict=True)):
                assert got_fp == expected_fp, (
                    f"Hash[{i}][{j}] mismatch: expected {expected_fp}, got {got_fp}"
                )

    def test_serialize_signature(self) -> None:
        """Test serializing signature to match Rust bincode output."""
        # First deserialize to get a valid signature object populated with Rust data
        sig_bytes = bytes.fromhex(RUST_SIG_HEX)
        signature = Signature.from_bincode_bytes(sig_bytes, XMSS_CONFIG)

        # Serialize it back using bincode
        result = signature.to_bincode_bytes(XMSS_CONFIG)
        expected = sig_bytes

        if result != expected:
            # Helper to find where the mismatch starts
            first_diff = next(
                (i for i, (a, b) in enumerate(zip(expected, result, strict=True)) if a != b), -1
            )
            raise AssertionError(
                f"Signature serialization mismatch:\n"
                f"  Expected length: {len(expected)} bytes\n"
                f"  Got length:      {len(result)} bytes\n"
                f"  First difference at byte: {first_diff}"
            )

    def test_signature_roundtrip(self) -> None:
        """Test serialize -> deserialize roundtrip for signatures to ensure stability."""
        sig_bytes = bytes.fromhex(RUST_SIG_HEX)

        # 1. Bytes -> Object
        sig1 = Signature.from_bincode_bytes(sig_bytes, XMSS_CONFIG)

        # 2. Object -> Bytes
        serialized = sig1.to_bincode_bytes(XMSS_CONFIG)

        # 3. Bytes -> Object
        sig2 = Signature.from_bincode_bytes(serialized, XMSS_CONFIG)

        # Verify fields match between the two objects
        assert sig1.rho == sig2.rho, "Rho mismatch after roundtrip"

        # Verify paths
        for i in range(len(sig1.path.siblings)):
            assert sig1.path.siblings[i] == sig2.path.siblings[i], f"Path sibling {i} mismatch"

        # Verify hashes
        for i in range(len(sig1.hashes)):
            assert sig1.hashes[i] == sig2.hashes[i], f"Hash chain {i} mismatch"

    def test_public_key_serialization(self) -> None:
        """
        Test PublicKey serialization/deserialization against Rust bincode output.

        Note: For PublicKey, Rust bincode is effectively identical to fixed-width serialization
        structurally, but field elements are still VarInt encoded.
        """
        pk_bytes = bytes.fromhex(RUST_PK_HEX)

        # 1. Deserialize
        pk = PublicKey.from_bincode_bytes(pk_bytes, XMSS_CONFIG)

        # Basic sanity check on lengths
        assert len(pk.root) == XMSS_CONFIG.HASH_LEN_FE
        assert len(pk.parameter) == XMSS_CONFIG.PARAMETER_LEN

        # 2. Serialize back
        result_bytes = pk.to_bincode_bytes(XMSS_CONFIG)

        assert result_bytes == pk_bytes, (
            f"Public Key serialization mismatch.\n"
            f"Expected: {RUST_PK_HEX}\n"
            f"Got:      {result_bytes.hex()}"
        )
